####{ CreativeBC }####| Light Group |####[ github.com/wfurphy/creative-button-card-templates ]####>
light_group:
  template:
    - light
    # - debug
  color: auto
  variables:
    items: []
    # height: 100px
    __defaults:
      entity_id: "[[[ return entity?.entity_id ]]]"
      icon: mdi:lightbulb
      symbol:
      display: "none"
  styles:
    grid:
      - grid-template-areas: >
          [[[
            if (!Array.isArray(variables.items) || !variables.items.length) {
              if(!entity || !entity.attributes?.entity_id || !Array.isArray(entity.attributes.entity_id)) {
                throw new Error("You must provide a light group entity or a list of items")
                return ''
              }

              entity.attributes.entity_id.forEach(function(e,i) { 
                variables.items.push({
              ...variables.__defaults, 
              ...{ 
                entity_id: e, 
                symbol: String(i+1) 
                }})
              })
            }


            variables._qty = variables.items.length > 6 ? 6 : variables.items.length
            let pre = '\"i'
            let cf = '\"'
            let post = '\"'

            for(let i = 0; i < variables._qty; i++) {
              const sp = i ? ' ' : ''
              pre += i ? ` n` : ''
              cf += `${sp}li${i+1}`
              post += `${sp}l`
              variables.items[i].display = 'block'
              variables.items[i] = {...variables.__defaults, ...variables.items[i]}
            }
            
            return pre + '\" ' + cf + '\" ' + post + '\" '
          ]]]
      - grid-template-columns: "[[[ return `repeat(${variables._qty}, 1fr)` ]]]"
      - grid-template-rows: 1fr 1fr 1fr
      - justify-items: center
      - align-items: center
      - padding: 4px
      - position: relative
      - max-width: 100%
    label:
      - justify-self: center
      - align-self: start
      - text-align: center
      - margin-top: -3px
    name:
      - justify-self: center
      - align-self: center
      - text-align: left
    custom_fields:
      li1:
        - display: "[[[ return variables.items[0]?.display || 'none' ]]]"
        - z-index: 5
        - justify-self: center
        - align-self: center
      li2:
        - display: "[[[ return variables.items[1]?.display || 'none' ]]]"
        - z-index: 5
        - justify-self: center
        - align-self: center
      li3:
        - display: "[[[ return variables.items[2]?.display || 'none' ]]]"
        - z-index: 5
        - justify-self: center
        - align-self: center
      li4:
        - display: "[[[ return variables.items[3]?.display || 'none' ]]]"
        - z-index: 5
        - justify-self: center
        - align-self: center
      li5:
        - display: "[[[ return variables.items[4]?.display || 'none' ]]]"
        - z-index: 5
        - justify-self: center
        - align-self: center
      li6:
        - display: "[[[ return variables.items[5]?.display || 'none' ]]]"
        - z-index: 5
        - justify-self: center
        - align-self: center
  custom_fields:
    li1:
      card:
        type: custom:button-card
        template: 
          - button_mini_embed
          - actions
        entity: "[[[ return variables.items[0]?.entity_id ]]]"
        icon: "[[[ return variables.items[0]?.icon ]]]"
        color: auto
        variables:
          symbol: "[[[ return variables.items[0]?.symbol ]]]"
    li2:
      card:
        type: custom:button-card
        template: 
          - button_mini_embed
          - actions
        entity: "[[[ return variables.items[1]?.entity_id ]]]"
        icon: "[[[ return variables.items[1]?.icon ]]]"
        color: auto
        variables:
          symbol: "[[[ return variables.items[1]?.symbol ]]]"
    li3:
      card:
        type: custom:button-card
        template: 
          - button_mini_embed
          - actions
        entity: "[[[ return variables.items[2]?.entity_id ]]]"
        icon: "[[[ return variables.items[2]?.icon ]]]"
        color: auto
        variables:
          symbol: "[[[ return variables.items[2]?.symbol ]]]"
    li4:
      card:
        type: custom:button-card
        template: 
          - button_mini_embed
          - actions
        entity: "[[[ return variables.items[3]?.entity_id ]]]"
        icon: "[[[ return variables.items[3]?.icon ]]]"
        color: auto
        variables:
          symbol: "[[[ return variables.items[3]?.symbol ]]]"
    li5:
      card:
        type: custom:button-card
        template: 
          - button_mini_embed
          - actions
        entity: "[[[ return variables.items[4]?.entity_id ]]]"
        icon: "[[[ return variables.items[4]?.icon ]]]"
        color: auto
        variables:
          symbol: "[[[ return variables.items[4]?.symbol ]]]"
    li6:
      card:
        type: custom:button-card
        template: 
          - button_mini_embed
          - actions
        entity: "[[[ return variables.items[5]?.entity_id ]]]"
        icon: "[[[ return variables.items[5]?.icon ]]]"
        color: auto
        variables:
          symbol: "[[[ return variables.items[5]?.symbol ]]]"


#########################################################################/

